#!/bin/sh
set -e

CONFIG_DIR="/work/config/jupyter"

log() { echo "[JUPYTER] $1"; }

init_config() {
    if [ ! -d "$CONFIG_DIR" ] || [ ! -f "$CONFIG_DIR/jnl.py" ]; then
        log "Creating default config..."
        mkdir -p "$CONFIG_DIR"
        cp -a /build/config/jupyter/jnl.py "$CONFIG_DIR/"
    fi
    mkdir -p "$CONFIG_DIR/lab/user-settings" "$CONFIG_DIR/lab/workspaces"
}

init_config
log "Starting Jupyter Lab..."
exec /usr/local/bin/jupyter-lab --config "$CONFIG_DIR/jnl.py"
